"use strict";

// Used for UI purposes to give different theming for different kinds of upgrades
const LAITELA_UPGRADE_DIRECTION = {
  SELF_BOOST: 0,
  BOOSTS_MAIN: 1,
  BOOSTS_LAITELA: 2
};

GameDatabase.celestials.singularityMilestones = {
  // Infinite
  continuumMult: {
    start: 1,
    repeat: 5,
    limit: 0,
    description: "Continuum percentage multiplier",
    effect: completions => completions * 0.01,
    effectFormat: x => formatX(1 + x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_MAIN,
  },
  darkMatterMult: {
    start: 2,
    repeat: 20,
    limit: 0,
    description: "Dark Matter production multiplier",
    effect: completions => Math.pow(1.5, completions),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  darkEnergyMult: {
    start: 3,
    repeat: 30,
    limit: 0,
    description: "Dark Energy production multiplier",
    effect: completions => Math.pow(2, completions),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  darkDimensionCostReduction: {
    start: 4,
    repeat: 40,
    limit: 0,
    description: "Dark Matter Dimension upgrades are cheaper",
    effect: completions => Math.pow(0.85, completions),
    effectFormat: x => formatPercents(1 - x),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  singularityMult: {
    id: 5,
    start: 50,
    repeat: 1000,
    limit: 0,
    description: "You gain more Singularities",
    effect: completions => Math.pow(2, completions),
    effectFormat: x => formatX(x, 2, 0),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  // Limited
  autoCondense: {
    start: 8,
    repeat: 8,
    limit: 8,
    description: "Automatically condense Singularities after reaching the cap (with a delay)",
    effect: completions => [Infinity, 20, 15, 10, 5, 3, 2, 1, 0][completions],
    effectFormat: x => `${formatInt(x)}s`,
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  darkDimensionIntervalReduction: {
    start: 12,
    repeat: 40,
    limit: 5,
    description: "Dark Matter Dimension interval decrease",
    effect: completions => Math.pow(0.75, completions),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  darkDimensionAutobuyers: {
    start: 30,
    repeat: 10,
    limit: 4,
    description: "Dark Matter Dimension autobuyers",
    effect: completions => completions,
    effectFormat: x => ((x === 0) ? "No autobuyers" : `Dimension ${x} autobuyer`),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  // Unique
  darkMatterFromTesseracts: {
    start: 10,
    repeat: 0,
    limit: 1,
    description: "Tesseracts boost Dark Matter production",
    effect: () => Math.pow(1.20, player.celestials.enslaved.tesseracts),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_LAITELA,
  },
  dilatedTimeFromSingularities: {
    start: 100,
    repeat: 0,
    limit: 1,
    description: "Singularities improve the Dilated Time multiplier upgrade",
    effect: () => 1 + Math.log10(player.celestials.laitela.singularities) / 21,
    effectFormat: x => formatX(Math.clampMin(x, 1), 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_MAIN,
  },
  darkEnergyFromGlyphLevel: {
    start: 1000,
    repeat: 0,
    limit: 1,
    description: "Highest glyph level boosts Dark Energy production",
    effect: () => Math.clampMin((player.bestGlyphLevel - 10000) / 1000, 1),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_LAITELA,
  },
  momentumFromSingularities: {
    start: 1e4,
    repeat: 0,
    limit: 1,
    description: "Singularities boost Alchemy Momentum buildup speed",
    effect: () => Math.pow(Math.log10(player.celestials.laitela.singularities), 3),
    effectFormat: x => formatX(Math.clampMin(x, 1), 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_MAIN,
  },
  darkMultiplierFromAnnihilation: {
    start: 1e5,
    repeat: 0,
    limit: 1,
    description: "Annihilation boosts Dark Energy and Dark Matter production",
    effect: () => Math.clampMin(Math.log10(Laitela.darkMatterMult), 1),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  annihilationBoostFromSingularities: {
    start: 1e6,
    repeat: 0,
    limit: 1,
    description: "Singularities boost the Annihilation modifier",
    effect: () => Math.log10(player.celestials.laitela.singularities),
    effectFormat: x => formatX(Math.clampMin(x, 1), 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.SELF_BOOST,
  },
  darkEnergyFromGamespeed: {
    start: 1e7,
    repeat: 0,
    limit: 1,
    description: "Gamespeed boosts Dark Energy production",
    effect: () => Math.clampMin(Math.log10(getGameSpeedupFactor()) / 10 - 10, 1),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_LAITELA,
  },
  glyphLevelFromSingularities: {
    start: 1e8,
    repeat: 0,
    limit: 1,
    description: "Singularities boost glyph level",
    effect: () => 1 + Math.log10(player.celestials.laitela.singularities) / 20,
    effectFormat: x => formatX(Math.clampMin(x, 1), 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_MAIN,
  },
  darkMatterFromDilatedTime: {
    start: 1e9,
    repeat: 0,
    limit: 1,
    description: "Dilated Time boosts Dark Matter production",
    effect: () => Math.pow(2.2, Decimal.log10(player.dilation.dilatedTime.plus(1)) / 1000),
    effectFormat: x => formatX(x, 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_LAITELA,
  },
  tesseractMultFromSingularities: {
    start: 1e10,
    repeat: 0,
    limit: 1,
    description: "Singularities make Tesseracts stronger",
    effect: () => 1 + Math.log10(player.celestials.laitela.singularities) / 40,
    effectFormat: x => formatX(Math.clampMin(x, 1), 2, 2),
    upgradeDirection: LAITELA_UPGRADE_DIRECTION.BOOSTS_MAIN,
  }
};
